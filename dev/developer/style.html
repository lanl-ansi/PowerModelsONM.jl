<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Style Guide · PowerModelsONM</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">PowerModelsONM</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><a class="tocitem" href="../installation.html">Installation Guide</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../manual/quickguide.html">Getting Started</a></li><li><a class="tocitem" href="../manual/onm_workflow.html">The ONM Workflow</a></li><li><a class="tocitem" href="../manual/mld_model.html">Optimal Switch / Load shed Mathematical Model</a></li><li><a class="tocitem" href="../manual/opf_model.html">Optimal Dispatch Mathematical Model</a></li><li><a class="tocitem" href="../manual/graphml_export.html">Exporting with GraphML</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/Beginners Guide.html">Beginners Guide</a></li><li><a class="tocitem" href="../tutorials/Block MLD Basic Example.html">Block MLD Basic Example</a></li><li><a class="tocitem" href="../tutorials/JuMP Model by Hand - MLD-Block.html">JuMP Model by Hand - MLD-Block Example</a></li><li><a class="tocitem" href="../tutorials/JuMP Model by Hand - MLD-scenario.html">JuMP Model by Hand - MLD-Block Scenario Example</a></li><li><a class="tocitem" href="../tutorials/Use Case Examples.html">Use Case Examples</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../reference/base.html">Base functions</a></li><li><a class="tocitem" href="../reference/data.html">Data Handling</a></li><li><a class="tocitem" href="../reference/graphml.html">GraphML Functions</a></li><li><a class="tocitem" href="../reference/entrypoint.html">Main Entrypoint</a></li><li><a class="tocitem" href="../reference/internal.html">Internal Functions</a></li><li><a class="tocitem" href="../reference/io.html">IO Functions</a></li><li><a class="tocitem" href="../reference/logging.html">Logging</a></li><li><a class="tocitem" href="../reference/prob.html">Optimization Problems</a></li><li><a class="tocitem" href="../reference/stats.html">Solution Statistics</a></li><li><a class="tocitem" href="../reference/variable_constraint.html">Variables and Constraints</a></li><li><a class="tocitem" href="../reference/types.html">Types</a></li></ul></li><li><span class="tocitem">Schemas</span><ul><li><a class="tocitem" href="../schemas/output.schema.html">output.schema</a></li><li><a class="tocitem" href="../schemas/input-settings.schema.html">settings.schema</a></li><li><a class="tocitem" href="../schemas/input-events.schema.html">events.schema</a></li><li><a class="tocitem" href="../schemas/input-faults.schema.html">faults.schema</a></li><li><a class="tocitem" href="../schemas/input-runtime_arguments.schema.html">runtime-arguments.schema</a></li></ul></li><li><span class="tocitem">Developer Docs</span><ul><li><a class="tocitem" href="contributing.html">Contributing Guide</a></li><li class="is-active"><a class="tocitem" href="style.html">Style Guide</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Types-and-Enums"><span>Types &amp; Enums</span></a></li><li><a class="tocitem" href="#Constants"><span>Constants</span></a></li><li><a class="tocitem" href="#JuMP-Variables-and-Constraints"><span>JuMP Variables and Constraints</span></a></li><li><a class="tocitem" href="#Formulation-Styles"><span>Formulation Styles</span></a></li><li><a class="tocitem" href="#Problem-Specification-Styles"><span>Problem Specification Styles</span></a></li><li><a class="tocitem" href="#Metaprogramming"><span>Metaprogramming</span></a></li><li><a class="tocitem" href="#Markdown"><span>Markdown</span></a></li><li><a class="tocitem" href="#File-Structure"><span>File Structure</span></a></li><li><a class="tocitem" href="#Dependencies-(Project.toml)"><span>Dependencies (Project.toml)</span></a></li></ul></li><li><a class="tocitem" href="roadmap.html">Roadmap</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Docs</a></li><li class="is-active"><a href="style.html">Style Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="style.html">Style Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lanl-ansi/PowerModelsONM.jl/blob/main/docs/src/developer/style.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Style-Conventions"><a class="docs-heading-anchor" href="#Style-Conventions">Style Conventions</a><a id="Style-Conventions-1"></a><a class="docs-heading-anchor-permalink" href="#Style-Conventions" title="Permalink"></a></h1><p>In general, the following conventions should be adhered to when making changes or additions to the code base. These conventions should include any conventions applied across the InfrastructureModels ecosystem specific to power engineering (<em>i.e</em> conventions from InfrastructureModels, PowerModels, PowerModelsRestoration, etc.) with some additions specific to PowerModelsONM.</p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><p>Function additions should meeting the following criteria:</p><ul><li>All functions should be clearly named, without abbreviations, and with underscores between words, <em>e.g.</em> <code>parse_file</code> or <code>constraint_bus_voltage_magnitude</code>; in Python this is known as <a href="https://legacy.python.org/dev/peps/pep-0008/#descriptive-naming-styles"><code>lower_case_with_underscores</code></a>. The exception to the abbreviate rule is cases where abbreviations would be expected in the modeling of power systems.</li><li>All functions that are not prepended by an underscore <code>_</code> will be exported by default (<em>i.e.</em> when a user uses <code>using PowerModelsONM</code>). Public functions should have a detailed docstring instructing on usage</li><li>All functions that modify data in place should end with an exclamation point <code>!</code> and the function input that is being modified should be the first argument (or first arguments in the case where multiple inputs are being modified in place). The exceptions to this rule are constraint and variable creation functions (<em>i.e.</em> those functions related to JuMP model creation), which do not include the exclaimation point</li><li>All function arguments, including keyword arguments, should have their types specified.</li><li>Private functions, <em>i.e.</em> those intended to be for internal use only, should follow the same descriptive naming conventions as functions exported by default, and should always include docstrings to describe their purpose.</li><li>Functions should be separated by two blank lines</li></ul><pre><code class="language-julia hljs">&quot;this function demonstrates how an internal, in-place data altering function should be defined&quot;
function _concise_descriptive_name!(data::Dict{String,&lt;:Any}, a::Real, b::Vector{&lt;:Real}, c::Matrix{&lt;:Complex}; d::Bool=false, e::Vector{Function}=Function[])
end</code></pre><h2 id="Types-and-Enums"><a class="docs-heading-anchor" href="#Types-and-Enums">Types &amp; Enums</a><a id="Types-and-Enums-1"></a><a class="docs-heading-anchor-permalink" href="#Types-and-Enums" title="Permalink"></a></h2><p>When specifying types, <em>i.e.</em> when specifying the type of a function argument, or creating enums, these guidelines are recommended:</p><ul><li>Prefer to use <code>Vector{T}</code> instead of <code>Array{T,1}</code></li><li>Prefer to use <code>Matrix{T}</code> instead of <code>Array{T,2}</code></li><li>Enums should <strong>only</strong> be used in the <code>ENGINEERING</code> data model, never the <code>MATHEMATICAL</code> data model</li><li>Enums must be added to the JSON parser when introduced</li></ul><h2 id="Constants"><a class="docs-heading-anchor" href="#Constants">Constants</a><a id="Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Constants" title="Permalink"></a></h2><p>Whenever possible, <code>const</code> should be used to eliminate unnecesary re-evaluations of code, and every <code>const</code> should have a docstring, whether internal or public.</p><h2 id="JuMP-Variables-and-Constraints"><a class="docs-heading-anchor" href="#JuMP-Variables-and-Constraints">JuMP Variables and Constraints</a><a id="JuMP-Variables-and-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#JuMP-Variables-and-Constraints" title="Permalink"></a></h2><p>For functions that create JuMP variables and constraints in particular, we follow the following naming convention as originally adopted by PowerModels:</p><p><code>&lt;jump macro id&gt;(_&lt;phase variant&gt;)_&lt;comp short name&gt;_&lt;quantity name&gt;(_real|_imaginary|_magnitude|_angle|_factor)(_fr|_to)(_sqr)(_on_off)</code></p><p>in the interest of intuitive names for users, the following special cases are also acceptable,</p><ul><li><code>_power_real</code> -(can be replaced with)-&gt; <code>_active</code></li><li><code>_power_imaginary</code> -(can be replaced with)-&gt; <code>_reactive</code></li></ul><p>In the case of PowerModelsONM, there are additional tags indicating that a function is a multiconductor variant, three-phase specific, etc.:</p><ul><li><code>mc</code> multi-conductor, with an explicit neutral (which is the last conductor by convention?)</li><li><code>mp</code> multi-phase, for constraints that have no (explicit) neutral and multiple phases</li><li><code>3p</code> three-phase, when a constraint is hard-coded for three phases</li></ul><p>Currently, all phase-aware functions use <code>mc</code>, but this is subject to change in the future as we refactor. If the function is not multiphase specific, these are not needed in the function name.</p><h2 id="Formulation-Styles"><a class="docs-heading-anchor" href="#Formulation-Styles">Formulation Styles</a><a id="Formulation-Styles-1"></a><a class="docs-heading-anchor-permalink" href="#Formulation-Styles" title="Permalink"></a></h2><ul><li>All new formulations should have <strong>clear</strong> error messages when they do not support existing components. For example, if a formulation addition which is intended to work with OPF does not support delta-wye transformers, the <code>constraint_mc_transformer_power_dy</code></li><li>Formulation <code>abstract type</code> and <code>mutable struct</code> must be specified in <a href="https://legacy.python.org/dev/peps/pep-0008/#descriptive-naming-styles">CapitalizedWords</a>, which is a subtype of <a href="https://en.wikipedia.org/wiki/Camel_case">camelCase</a> with the first word also capitalized.</li></ul><h2 id="Problem-Specification-Styles"><a class="docs-heading-anchor" href="#Problem-Specification-Styles">Problem Specification Styles</a><a id="Problem-Specification-Styles-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Specification-Styles" title="Permalink"></a></h2><ul><li>If a new problem specification is only needed due to the requirements of a new formulation, and is not a new type of problem, <em>e.g.</em> another OPF formulation, a <code>build_</code> function with the same name as the existing formulation should be created that accepts a specific <code>PowerModel</code> (multiple dispatch)</li><li>If a new problem specification is a new type of problem that will <em>e.g.</em> accept multiple formulations, new <code>build_</code> and <code>run_</code> functions should be created that do not collide with existing problem specification functions</li></ul><h2 id="Metaprogramming"><a class="docs-heading-anchor" href="#Metaprogramming">Metaprogramming</a><a id="Metaprogramming-1"></a><a class="docs-heading-anchor-permalink" href="#Metaprogramming" title="Permalink"></a></h2><p>In general, it is better to avoid metaprogramming patterns, like creating functions algorithmically, in order to aid in the debugging of code. Metaprogramming can create significant challenges in interpreting stacktraces upon errors.</p><h2 id="Markdown"><a class="docs-heading-anchor" href="#Markdown">Markdown</a><a id="Markdown-1"></a><a class="docs-heading-anchor-permalink" href="#Markdown" title="Permalink"></a></h2><p>Markdown files should be properly formatted, particularly when including tables. Developers are encouraged to use <a href="https://github.com/markdownlint/markdownlint">markdownlint</a> and a markdown formatter (such as in VSCode).</p><h2 id="File-Structure"><a class="docs-heading-anchor" href="#File-Structure">File Structure</a><a id="File-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#File-Structure" title="Permalink"></a></h2><p>It is important that new functions, variables, constraints, etc. all go into appropriate places in the code base so that future maintenance and debugging is easier. Pay attention to the current file structure and attempt to conform as best as possible to it. In general</p><ul><li><code>src/app</code> contains the main ONM workflow, for uses in binaries, docker images, etc.</li><li><code>src/cli</code> contains the runtime arguments for the command line</li><li><code>src/core</code> contains the core logic of the package, including variable creation and constraint templates, <em>i.e.</em> things that are agnostic to the formulation</li><li><code>src/data_model</code> contains all of the logic to transform between the <code>ENGINEERING</code> and <code>MATHEMATICAL</code> data models and model creation helper tools</li><li><code>src/form</code> contains formulation specific variable and constraint functions, organized under separate files for different formulations</li><li><code>src/io</code> contains all of the tools to parse and save files, in particular all of the logic necessary to parse dss files and output json files</li><li><code>src/prob</code> contains all problem specifications</li><li><code>src/stats</code> contains all statistical analysis functions</li><li><code>docs/src</code> contains all source markdown files for the documentation</li><li><code>examples</code> contains Pluto.jl notebooks with walkthroughs of PowerModelsONM for new users</li><li><code>schemas</code> contains JSON Schemas for supported I/O file formats</li></ul><h2 id="Dependencies-(Project.toml)"><a class="docs-heading-anchor" href="#Dependencies-(Project.toml)">Dependencies (Project.toml)</a><a id="Dependencies-(Project.toml)-1"></a><a class="docs-heading-anchor-permalink" href="#Dependencies-(Project.toml)" title="Permalink"></a></h2><p>All new dependencies should be carefully considered before being added. It is important to keep the number of external dependencies low to avoid reliance on features that may not be maintained in the future. If possible, Julia Standard Library should be used, particularly in the case where reproducing the desired feature is trivial. There will be cases where it is not simple to duplicate a feature and subsequently maintain it within the package, so adding a dependency would be appropriate in such cases.</p><p>All new dependencies are are ultimately approved should also include an entry under <code>[compat]</code> indicating the acceptable versions (Julia automerge requirement). This includes test-only dependencies that appear under <code>[extras]</code></p><p>The <code>Manifest.toml</code> <strong>should not</strong> be included in the repo.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="contributing.html">« Contributing Guide</a><a class="docs-footer-nextpage" href="roadmap.html">Roadmap »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 31 May 2023 15:53">Wednesday 31 May 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
